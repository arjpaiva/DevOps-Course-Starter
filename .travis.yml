language:
services:
  - docker
env:
  global:
    - secure: iXLBgM1X3DgWPQzZmvLfoacNW9cykid48FF1gvC4Sah5mD8xQv/zUDWgxi63448C+jSPD6pksJ3UUEAOFL1V7kWUbVDvUK3r8WdNQHE1oJvExZduXm7oazQgov0CFMdU+P59GKgBa4WfGNy6c9lNyaI6AU/bAm2e9Gm6w0DAcn7P7upltAYmBIP3KSTl9m4qVj6ZP6JI/W2h/LWmi/a/CZLVRdFtOjpmynonoj49KvsyPhAvjiIh3c1nJx5kSaaxx9ThULT/y8IApVzZO7OQ3mJ6gbu6X9JpJSf2GQ0Z0ghdkBzWEquJDDIV5Joqo6dXkGC1QmJ9PcGwDtHMSMNlmt8H+YyZnfGaDzZFQnZh9mgH3h9nFgKANk+Yhb2ipgti+qnS0sSnOJpq6ytwX8Lhl/33XoP5ED3FP0435UTNK1OujSUQ0u7hthw3BnZCOXyP1R7uK+7U3usznF7CkhmFwl0Rnin5l9IMfyGJzq2q3IxpiZ6z2ZCz7/maVKYNGLSqpBxzbTo+7eFbvxQKpD1o/Zf4O17wMo0oF3e0OxR3ISj6kphQDbaO/q4R6+4D40iJgYFPmgRjVazZcP2Zueu0XzQiBaRRTMp5nOuq0YpTZOdVMqzIQoXl09vA/9Zxkpv6iw3pktwNy4Tqh9s8iNhx2GplVlzQfjsEC6xOReVCfs4=
    - secure: IuLuPb0QJ+FkdJtbLIYiIDREfYgvpCrOuZIeYPMLAvqJ/Zm16n7+JmreNm0VDdtp3pLJz/RS/d1W6gUJLm1+C2U+fCGnIbQSZ06d7zldZJw3g8O7UwtGUXfGf6oo5jsgluDhVkdJjYqFA9592vX9b0L9HAQkUyNCub6ofrdaCv3DF90Fe/i12csCkOTjmpFaDq8lIORyWbWSZpt4V97os72I44y4SN4IZexhinSS8LsGWCnP1ttdXsKiI0qK/ICWXi8hpjoOOswpDdIssqWtsRStmKBqZnxML2k18JQytintqiQPMu+FmsU5zPxoPqQzppkR3i9JIzVQm+3LjgofYIc7I4kOc8VPgURp4gn2MbRbJt7sThtsALaN2Do/ppFBTtIt0Kbs/OXOagtZkfeOK4mhFL8ECErM3q40xqfd0qVNrkddUTN6dOJZgh9j2S88QdN1W6FYYrFgpAgYm/y4MsOSPpzVK3R5G0t7UQ2uMmOfhLZolmBPMtBVJLGsv+vkdU0d2F0kajes6kRjoB9+ZhtUmuL/HZygrRdoeI6NItJl6Hk2KHmse4yLdAPpUaDLIJFz3hLWj0MR7OHQOZ82zoiMnXR+KpUK5MnGFtU7IOG3kmShryBIRBJg5ubOywZuh2Bk4vOY3P/TDQhC1kPAc4HrrrcmCtcY0SnwFFV51OY=
    - secure: mEpqWg5ctylIcZbFwvg2UZsMcKdj4m8qMfCFR2buinZMPV+6NPxnNOHGI6CNhCr0g2+ArdGt5giseXyojuJe0gA+K8XRo8SIFTbolh7+1uwbMDCBYhRcm46ubqRKFqWG9vqaV08lSb73uBnB7iOdmPrYFObN7njwBPHDkb0wnWlhLRybqHjr1lYh5GrZGyqmWrq/320KVt7pLc8Vy7Z9FMSfh/TwQYKx0Ak+YVm0NOpvD/GhmkyzPW6RzA2xQfxR23NF6ohxX/8bjYrJAQfvNDEO+jyZn5VG0KuaDqCJENuBtk+CJVLwI8woNxClWTHioh5fqaUAQq6v8kj6HB4UoYeGiOyBcaVngbNr1e93dKiSotYjc2yWRhikuvjug2bCGt91aeIuaeTnlbvlWH7u0B1k9FLTG/sRDXyBJO0AbTWtr+Cpao5F7g8Fw1TARmaSY+SqUGAnu6/9zaJzlrKGIX/UiJGhQQ0BTQKO4smW5J5w1bBFyFpdFAzJ3wptTSFunBvvoL8UJxsi/I2ZD54KMLjPb22nT/SgTMoHthzybZrpE9BAWKhavP7phSfHCSleHha/hhDo2Dn1+lPPQMkyfjQso6TOSL1VT2mDqY2uWYd33ox/WCdsGo+a8eENoEZ5dLDZDDpkqvsE4Od/V/iKL3vcvWCRRhliPe+E0KqvFEc=
    - secure: rA46HL5dngyeENMOwcUdzYiVluZmgmCnyWnOHAp0EumhbW4Dgi9twGDtuYhsZvl/f9eAn0/LATD/qcJf8jJ3HwbO3bzY4kxs0RveM/yPOj+A2M42qhkPDgZk7y90MiZp362ZAEv4I4aQBcUUytzt7e6ghDyGW/OU/a8VBV9P/7wsmQqAlQcccn5OZ6HEZYfdF4quW+RkCmsLh3c7bRSzs/+ACdS3p4LeNcRYkzBPTN8Yy/HR/BO1HAfjfHzFP+TUoHRiDehXjdXcMOqFFTOjJL1lMoq4/9Qrk2bqx7TNZJxFs0lPXboT/+WmQXQgEDoltHXtNdnS+rGqppBdMP1jxZAA0KJ+tg/HYmTY71qnWJEZKCtVivj0VgAa7nnhnJqC/+5ZnoN87l9WrdZMzAxSkGJJ67eVRcK0G2F0xJiT7hEsQuAkzeUQjqkrtG5vbewc/hRAp3ayJ46OHctHzg/tNsO1jT3p0HV8I74anBO8fV1s9wuNHhPwwvNgP0tR71GjXkDK2fV2wwJ1gtYuURoFI0G4Uo0MjX21XGbr87Hry5T4RddA+f2Xs2Mn84AP6C7EPrvfcUT3sQoRFbvy6qMAUatICGWJG0UsghbRqsIZ0M33BQpi8dpDBGvbGcaKAOd4sf2fmjDETjKG9E43YahSetVDWpOEP0SwPze7wSywWB8=
    - secure: NN8AAFBJogSBy34oGTsqulBWz8PS1T0Jh8WVv8QYilesUMyc+agRdYmzgPZpVJl1hkX2gmlmn1AnEMYM2Chc/ILCVPk9tXLCRZHGqvfZKbefwKLg3YY+cf8B3dVsfi7qZATlZXbHE4YvvO4iw+Vyp2s5Rs3j0pXT8wx1zzyS/jB+FT3VR+F7m4p0wfWrDV07uf5A9DtpLf1rvWLzNmp/pQyMY5dj33zAkWz0Loso3QVeAbt6+LeIpBnQ8myJ3qBf0BD0BTiYFHEZgKIMKHagv7qZOt9N3qIJYipK86CCRQBJVUTfBjxj9ZJEmNJIOmnIcUEwAC2z2eJtVe/S1DqsBs+v+vrS7T2J+t2HTjh8BJcVjdIUL6RUB8HPmXhacNy1KggB7iKIOPSzEB/qkuExgITwYebJ2YBeXjR6P8QrmELwdes3IXFdDa217slQfg9ub5fhNbtQ3ygn1dIzrQnZ+vTGWGFd7iB3LTVWe41P5XKWx8zK8U5SuAoK9V96E3cbbMEQE2mKFL3EFB5XfPSArigB+Y/kPa7/Fz1LhKcV+9dNRIM0FQNzID+tqCJxbD+F4o/thkOutFSo3XLklQwpgKLdG1mXSMMLo/cKe1DeBvKQve1l50te7aC++c++dPqJoocc4kMCc7RP2IFg0k6IP3N/vL8a83v4jSoOTA9GCSE=
    - secure: uHJMgeGylIMWy7XAEjukqr0YbCtNNfumzEdAA9pH8/vDRXKTyYX+1InOc6ZN1btTpKyF3f+QH2pj2459qNhS36p4fbW6v9kLiBGjjxEariapa0PSLs8p/VYN8DQ/q73J6cy2qMsN+2Rv/+PDg0g4pR9vxPs0Q8xJMjOxkLtr7zk395eff18sfL+3ucydAjxByZpQdqb4fcgcWmtspHiIdXZ6EQU9zisHFYA7nAsKQFzZoICX6exX3bkwpzZDuxSph+M1G7UYulbjUzXfa9vJaZIxu9+AtMDQ60XOTZCLNpM1TbGS6FenZolUSiIj5NiFgOTbnlh8A+xeCGihi9oCIrdI3HsBtW4L+bY+zNO6/tDLFoTfscLkk0RkdObBKLuBLZf/i3v9OvVzsK3tyUqlpJfLJShhFArbnHDREvJX+3Wagj8rgp2B6zefatfRkeUno36M+Aae3gzvjmXEpjpeOamFg0ZAV/YOQQghuwKnfqvLHBInKHwNCvdgzNJVDSRqadp9AlO0lHs6uvOTrPh2z/9wSU2BPAVtz5xFtV/+PhX7Z4FrwqoWhjkOFGdlV6D7fxrdcv8ZZHH8GFDisyzcOeOIiw80voy1pq4PZRkMxNqmVYN9CxkKEtXSbynbMrVl38jPpMwp1Kb4LUk9Vs3QgZBj8pG3bKYDgPKJCu+f8/A=
    - secure: AVPaCNfdPKr+MCKwHA/gJsnjBx4TacaOvh169U1duIK+GgVjy8PkW547q5lrgrWi/t3P1vg/wqHP/JSVZy3fz2FMtvniYFgU5KDXp4Eqzs01P524ZZVbKHfaRfnmgv4XCfISUhravLR0OTgtLdQRaH9e6QpJgekJ1u6g2RvuODI7hK8pgcs8qPBG/4MVwEBmfcU2Azp2Ws0NwtxecGEf3LpIiaFq4v3fPDFBJvydZaIW800slM3IKkPo9a5nCB1kIgHGCMfVbZueUwHIRyq7YpxVTXyfUeZZTkEeAR2oEsy1O/Bq2KU4mTfkSXTIxFn1jl9MkJ4JoHGbgg9MAGk+FkYcA3ZU5M2+IquhCQi0vqdMAtV96Zb8O5WYQTSD/nv2KdIWCVKTtYZiWPfiN3/yVsfHRvcWfsEycMmAJp/cOlXrMoqSozWIhVsDr93QxGzz46V1yS/DWX7iIu2nztsZ5nwtOhtyPcclN3mzZTU336kHIDIrM3oJwGOiuUc3aqB18C0FueG1PlmAIydkyJF038rcibXQGf7NLRAwJS9MJZBS0IK9YcnGm19m5OO4R+Hrufh4ah2H5SkA0zpQd5YQcJD1sUKoDfhS661hEqabrzVbCh8Z6ckq6cSasTEJnL0bWz9tHJYuMzJHHpz0shyL2dGSB0iWTYv/MugaZasu/SU=
script:
  - "echo 'im here'"
  - docker build --target test -t todo-app-test:test .
  - docker run --env-file .env.test todo-app-test:test test/test_view_model.py
  - docker run --env-file .env.test todo-app-test:test test/test_client.py
  - docker run -e TRELLO_KEY=$TRELLO_KEY -e TOKEN=$TOKEN -e SECRET_KEY=$SECRET_KEY todo-app-test:test test/test_app.py
before_deploy:
  - docker build --target production -t ritapaiva/todo-app:$TRAVIS_COMMIT .
  - docker login -u ritapaiva -p $DOCKERHUB_PASSWORD
  - docker push ritapaiva/todo-app:$TRAVIS_COMMIT
  - docker tag ritapaiva/todo-app:$TRAVIS_COMMIT registry.heroku.com/ritapaiva-todo-app/web
  - echo $HEROKU_API_KEY | docker login --username $HEROKU_LOGIN --password-stdin registry.heroku.com
  - docker push registry.heroku.com/ritapaiva-todo-app/web
deploy:
  provider: script
  script: heroku container:release web --app ritapaiva-todo-app
  on:
    branch: master
jobs:
  if: type = pull_request
notifications:
  slack:
    secure: CCTUU/yO9/o7ZsJG53jf0UwJ2UgdLY+NohQszyPKH2Vrb9TdShYES/Rx5jiFIUbunoGAKuU2VAYkjYh+zu1E9hWe3Dm74/Fl+meUV01c9yZVR97UmocbPEpzVd0d46srHUTBSBhU4bED4/E3raIYnzSd4hGi9iNC1ywKaofudDVbKULRibQ1gvZ1sFCgiC6fS+eI0FMC9guRrJDNla1ISgOC4kaZRQl5L6F0EYVxyA6SU37jrFbXkEK54hqtFrG8eM+OqsnxETQV+8eceyvTf8vgQmX3uZXyhPpplemBkFZYB+YHQK+M4OUak7B7+kiBvH4gFoo9qTanajhvrvWVsKAhzVlm7JjeeFF+8exzqZIrqOKo0hbLE+ttf54ta8ZqGSN0aMiniAjN4oa+hg9vFRT0mPaXZdX40mtcPyMnaoMrLQ3WG6qHeTe7KldAVWajktJXg8g9bAVe3bGVLHftZsKoKLBMFmT1jDZDmOweSZLwN0y/TSzMGuvKlKabDOv3lFq55vMhbdkuK+eJucd8j8DOc4CcwB91TeUiduxlzASs8OBosWhfep7iCAjYzhSl6XLEhfW8IZwrpNsPyvGDAbzO9RlCLSfj/r1NBuZt1S5i+n0vY8ygKk/p+/oHIIHu5Pv8RyhyvTygJ+Xi3WVD2hpVQ2/P7Irs115w2Fa9xBY=
